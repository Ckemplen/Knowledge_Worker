<div id="base-dialog" class="govuk-width-container" hidden>
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <div class="govuk-notification-banner" role="region" aria-labelledby="dialog-title">
                <div class="govuk-notification-banner__header">
                    <h2 class="govuk-notification-banner__title" id="dialog-title"></h2>
                </div>
                <div class="govuk-notification-banner__content">
                    <p class="govuk-body" id="dialog-message"></p>
                    <div class="govuk-button-group" id="dialog-actions">
                        <!-- Buttons will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    class Dialog {
        constructor() {
            this.dialog = document.getElementById('base-dialog');
            this.title = document.getElementById('dialog-title');
            this.message = document.getElementById('dialog-message');
            this.actions = document.getElementById('dialog-actions');
        }

        show(title, message, buttons) {
            // Clear previous buttons
            this.actions.innerHTML = '';
            
            // Set content
            this.title.textContent = title;
            this.message.textContent = message;
            
            // Add buttons
            buttons.forEach(button => {
                const btn = document.createElement('button');
                btn.className = `govuk-button ${button.classes || ''}`;
                btn.textContent = button.text;
                btn.onclick = () => {
                    this.hide();
                    if (button.callback) {
                        button.callback();
                    }
                };
                this.actions.appendChild(btn);
            });
            
            // Show dialog
            this.dialog.hidden = false;
        }

        hide() {
            this.dialog.hidden = true;
        }
    }

    // Create global dialog instance
    const dialog = new Dialog();

    // Add htmx confirmation handler
    document.body.addEventListener('htmx:confirm', function(evt) {
        evt.preventDefault();
        dialog.show(
            'Confirmation',
            evt.detail.question,
            [
                {
                    text: 'Confirm',
                    classes: 'govuk-button--warning',
                    callback: () => evt.detail.issueRequest(true)
                },
                {
                    text: 'Cancel',
                    classes: 'govuk-button--secondary'
                }
            ]
        );
    });
</script>
